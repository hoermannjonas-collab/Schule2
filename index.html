<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sortimentspyramide - √úbung</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { touch-action: manipulation; }
        .dragging { opacity: 0.5; transform: scale(1.05); }
        .drop-highlight { box-shadow: 0 0 0 3px white, 0 0 0 6px rgba(59, 130, 246, 0.5); }
    </style>
</head>
<body class="bg-slate-100">
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useRef } = React;

        const SortimentspyramideUebung = () => {
            const [placements, setPlacements] = useState({
                'Sortimentsbereich': [],
                'Warengruppe': [],
                'Warenart': [],
                'Artikel': [],
                'Sorte': []
            });
            const [showResults, setShowResults] = useState(false);
            const [score, setScore] = useState(null);
            const [selectedItem, setSelectedItem] = useState(null);
            const dragRef = useRef(null);

            const correctAnswers = {
                'Sortimentsbereich': ['Lebensmittel', 'Textil/Bekleidung'],
                'Warengruppe': ['Molkereiprodukte', 'Herrenoberbekleidung'],
                'Warenart': ['Joghurt', 'Businessbekleidung'],
                'Artikel': ['Dextra-Power-Fruit 250-g-Becher', 'Business-Anzug'],
                'Sorte': ['Cranberry', 'anthrazit, Gr√∂√üe 52']
            };

            const allItems = [
                // Joghurt-Beispiel
                { text: 'Lebensmittel', color: 'from-purple-500 to-purple-600' },
                { text: 'Molkereiprodukte', color: 'from-purple-500 to-purple-600' },
                { text: 'Joghurt', color: 'from-purple-500 to-purple-600' },
                { text: 'Dextra-Power-Fruit 250-g-Becher', color: 'from-purple-500 to-purple-600' },
                { text: 'Cranberry', color: 'from-purple-500 to-purple-600' },
                // Anzug-Beispiel
                { text: 'Textil/Bekleidung', color: 'from-teal-500 to-teal-600' },
                { text: 'Herrenoberbekleidung', color: 'from-teal-500 to-teal-600' },
                { text: 'Businessbekleidung', color: 'from-teal-500 to-teal-600' },
                { text: 'Business-Anzug', color: 'from-teal-500 to-teal-600' },
                { text: 'anthrazit, Gr√∂√üe 52', color: 'from-teal-500 to-teal-600' }
            ];

            const pyramidLevels = [
                { level: 1, name: 'Sortimentsbereich', color: 'bg-red-500', width: '100%' },
                { level: 2, name: 'Warengruppe', color: 'bg-orange-500', width: '85%' },
                { level: 3, name: 'Warenart', color: 'bg-yellow-500', width: '70%' },
                { level: 4, name: 'Artikel', color: 'bg-green-500', width: '55%' },
                { level: 5, name: 'Sorte', color: 'bg-blue-500', width: '40%' }
            ];

            // Alle platzierten Begriffe sammeln
            const placedItems = Object.values(placements).flat();
            
            const availableItems = allItems.filter(
                item => !placedItems.includes(item.text)
            );

            const getItemColor = (text) => {
                const item = allItems.find(i => i.text === text);
                return item ? item.color : 'from-gray-500 to-gray-600';
            };

            // Click to select (mobile-friendly)
            const handleItemClick = (item) => {
                if (selectedItem === item) {
                    setSelectedItem(null);
                } else {
                    setSelectedItem(item);
                }
            };

            const handleLevelClick = (levelName) => {
                if (selectedItem && placements[levelName].length < 2) {
                    setPlacements(prev => ({
                        ...prev,
                        [levelName]: [...prev[levelName], selectedItem]
                    }));
                    setSelectedItem(null);
                }
            };

            const handleRemove = (levelName, itemToRemove, e) => {
                e.stopPropagation();
                setPlacements(prev => ({
                    ...prev,
                    [levelName]: prev[levelName].filter(item => item !== itemToRemove)
                }));
            };

            const checkAnswers = () => {
                let correct = 0;
                pyramidLevels.forEach(level => {
                    const placed = placements[level.name];
                    const correct_items = correctAnswers[level.name];
                    placed.forEach(item => {
                        if (correct_items.includes(item)) {
                            correct++;
                        }
                    });
                });
                setScore(correct);
                setShowResults(true);
            };

            const resetExercise = () => {
                setPlacements({
                    'Sortimentsbereich': [],
                    'Warengruppe': [],
                    'Warenart': [],
                    'Artikel': [],
                    'Sorte': []
                });
                setShowResults(false);
                setScore(null);
                setSelectedItem(null);
            };

            const isItemCorrect = (levelName, item) => {
                return correctAnswers[levelName].includes(item);
            };

            const totalPlaced = Object.values(placements).flat().length;

            return (
                <div className="min-h-screen bg-gradient-to-b from-slate-100 to-slate-200 p-3 md:p-8">
                    <div className="max-w-4xl mx-auto">
                        {/* Header */}
                        <div className="text-center mb-4">
                            <h1 className="text-xl md:text-3xl font-bold text-slate-800 mb-1">
                                üè™ Sortimentspyramide
                            </h1>
                            <p className="text-slate-600 text-sm md:text-base">
                                Ordne alle Begriffe zu ‚Äì je 2 pro Ebene!
                            </p>
                            <div className="flex justify-center gap-4 mt-2 text-xs">
                                <span className="flex items-center gap-1">
                                    <span className="w-3 h-3 rounded bg-gradient-to-r from-purple-500 to-purple-600"></span>
                                    Joghurt-Produkt
                                </span>
                                <span className="flex items-center gap-1">
                                    <span className="w-3 h-3 rounded bg-gradient-to-r from-teal-500 to-teal-600"></span>
                                    Business-Anzug
                                </span>
                            </div>
                        </div>

                        {/* Draggable Items */}
                        <div className="bg-white rounded-xl shadow-lg p-3 mb-4">
                            <h2 className="text-sm font-semibold text-slate-700 mb-2">
                                üì¶ Begriffe {selectedItem ? <span className="text-blue-600">(ausgew√§hlt: {selectedItem})</span> : '(antippen zum Ausw√§hlen)'}:
                            </h2>
                            <div className="flex flex-wrap gap-2 min-h-[50px]">
                                {availableItems.length > 0 ? (
                                    availableItems.map((item, index) => (
                                        <div
                                            key={index}
                                            onClick={() => handleItemClick(item.text)}
                                            className={`px-3 py-2 bg-gradient-to-r ${item.color} text-white rounded-lg cursor-pointer shadow-md transition-all text-xs md:text-sm select-none ${
                                                selectedItem === item.text ? 'ring-4 ring-yellow-400 scale-105' : 'hover:scale-105 active:scale-95'
                                            }`}
                                        >
                                            {item.text}
                                        </div>
                                    ))
                                ) : (
                                    <p className="text-slate-400 italic text-sm">‚úì Alle Begriffe zugeordnet!</p>
                                )}
                            </div>
                        </div>

                        {/* Pyramid */}
                        <div className="bg-white rounded-xl shadow-lg p-3 md:p-4 mb-4">
                            <h2 className="text-sm font-semibold text-slate-700 mb-3">
                                üî∫ Pyramide (je 2 Begriffe pro Ebene):
                            </h2>
                            <div className="flex flex-col items-center gap-2">
                                {pyramidLevels.map((level) => (
                                    <div
                                        key={level.level}
                                        style={{ width: level.width }}
                                        className="transition-all duration-300"
                                    >
                                        <div
                                            data-level={level.name}
                                            onClick={() => handleLevelClick(level.name)}
                                            className={`${level.color} rounded-lg p-2 md:p-3 transition-all cursor-pointer ${
                                                placements[level.name].length < 2 ? 'border-2 border-dashed border-white/50' : ''
                                            } ${
                                                selectedItem && placements[level.name].length < 2 ? 'animate-pulse' : ''
                                            }`}
                                        >
                                            <div className="flex flex-col gap-1">
                                                <div className="flex justify-between items-center">
                                                    <span className="text-white font-bold text-xs md:text-sm">
                                                        {level.level}. {level.name}
                                                    </span>
                                                    <span className="text-white/70 text-xs">
                                                        {placements[level.name].length}/2
                                                    </span>
                                                </div>
                                                
                                                <div className="flex flex-wrap gap-1 min-h-[32px]">
                                                    {placements[level.name].length > 0 ? (
                                                        placements[level.name].map((item, idx) => (
                                                            <div key={idx} className="flex items-center gap-1">
                                                                <span className={`bg-gradient-to-r ${getItemColor(item)} text-white px-2 py-1 rounded text-xs md:text-sm font-medium ${
                                                                    showResults ? (isItemCorrect(level.name, item) ? 'ring-2 ring-green-300' : 'ring-2 ring-red-300') : ''
                                                                }`}>
                                                                    {item}
                                                                    {showResults && (
                                                                        <span className="ml-1">
                                                                            {isItemCorrect(level.name, item) ? '‚úÖ' : '‚ùå'}
                                                                        </span>
                                                                    )}
                                                                </span>
                                                                {!showResults && (
                                                                    <button
                                                                        onClick={(e) => handleRemove(level.name, item, e)}
                                                                        className="bg-white/30 hover:bg-white/50 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs transition-colors"
                                                                    >
                                                                        ‚úï
                                                                    </button>
                                                                )}
                                                            </div>
                                                        ))
                                                    ) : (
                                                        <span className="text-white/60 italic text-xs">
                                                            {selectedItem ? 'üëÜ Hier tippen!' : '2 Begriffe zuordnen...'}
                                                        </span>
                                                    )}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        {/* Results */}
                        {showResults && (
                            <div className={`rounded-xl p-3 mb-4 text-center ${
                                score === 10 ? 'bg-green-100 border-2 border-green-400' : 'bg-amber-100 border-2 border-amber-400'
                            }`}>
                                <p className="text-lg font-bold">
                                    {score === 10 ? 'üéâ Perfekt!' : 'üìù Ergebnis:'} {score}/10 richtig!
                                </p>
                                {score < 10 && (
                                    <p className="text-slate-600 text-sm mt-1">
                                        Von allgemein (oben) ‚Üí spezifisch (unten)
                                    </p>
                                )}
                            </div>
                        )}

                        {/* Buttons */}
                        <div className="flex justify-center gap-3">
                            {!showResults ? (
                                <button
                                    onClick={checkAnswers}
                                    disabled={totalPlaced < 10}
                                    className={`px-5 py-3 rounded-lg font-bold text-white transition-all text-sm ${
                                        totalPlaced < 10
                                            ? 'bg-slate-400 cursor-not-allowed'
                                            : 'bg-green-600 hover:bg-green-700 shadow-lg active:scale-95'
                                    }`}
                                >
                                    ‚úì √úberpr√ºfen ({totalPlaced}/10)
                                </button>
                            ) : (
                                <button
                                    onClick={resetExercise}
                                    className="px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-bold shadow-lg transition-all active:scale-95 text-sm"
                                >
                                    üîÑ Nochmal
                                </button>
                            )}
                        </div>

                        {/* Info Box */}
                        <details className="mt-4 bg-slate-50 rounded-xl border border-slate-200">
                            <summary className="p-3 font-semibold text-slate-700 cursor-pointer text-sm">
                                üí° Info zur Sortimentspyramide
                            </summary>
                            <div className="px-3 pb-3">
                                <ul className="text-xs text-slate-600 space-y-1">
                                    <li><strong>1. Sortimentsbereich:</strong> Breiteste Kategorie (z.B. Lebensmittel, Textil)</li>
                                    <li><strong>2. Warengruppe:</strong> Zusammengeh√∂rige Warenarten (z.B. Molkereiprodukte)</li>
                                    <li><strong>3. Warenart:</strong> Gleichartige Artikel (z.B. Joghurt)</li>
                                    <li><strong>4. Artikel:</strong> Konkretes Produkt (z.B. bestimmter Becher)</li>
                                    <li><strong>5. Sorte:</strong> Spezifische Variante (z.B. Geschmack, Farbe)</li>
                                </ul>
                            </div>
                        </details>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<SortimentspyramideUebung />, document.getElementById('root'));
    </script>
</body>
</html>
